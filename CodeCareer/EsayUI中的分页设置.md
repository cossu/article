## EsayUI中的分页设置

之前做页面，在查看调用easyui-datagrid 组件效果的时候发现表格的右侧多了一列滚动条，并且easyui-datagrid控件的翻页和每页显示条数也没起效果。经研究发现原因是*分页*效果没做。下面就总结一下如何分页以及分页的原理。
easyui-datagrid控件下部的设置栏共有两个属性，*页码**每页显示条数*。这两个属性已经被控件用`page`和`rows`包装好，在在加载表格的时候会自动传进后台。我们完全不需要再前台做任何操作，只需要在用的时候，在后台手动获取一下就ok了。比如：

```
int rows=Context.Response.QuerryString["rows"];
int page=Context.Response.QuerryString["page"];
```

现在有了页码和每页条数的信息，那么分页效果究竟怎么实现呢？思路是这样的：既然既然页码、每页的显示数目都有了，那么我们只要排除出已读的序列（rows*page），然后往下的rows条数据就是我们所需要的了。
读数据我们可以选择“select * from MyTable where ……”。至于*排除出已读序列*这一动作我们可以利用数据库查询语句中`not in`和`top`这两个关键字来实现。简单举例如下：

```
select top（rows） * from MyTable as A where ……
and  A.ID not in 
（select top（（page-1）*rows）A.ID from MyTable as A where……）
```

这里面有三个个要注意的地方：

-   where语句中的条件可以随便添加（这也意味着我们可以在后台随意组装我们所需要的sql语句），但是前后两个where语句一定要一样才能做出正确的分页效果，如果不一样的话很可能查不出数据。
-  `not in` 这个关键字要注意一下，它后面跟着的查询语句一定的查询结果一定只能有一列，不然会报错。而且我后一句的目的仅仅在于排除前一句结果（所查出表格）中我们不想要的数据行，所以只要查出keyword列就可以了（例子中我选择的是`ID`）。
-   另外如果想要加排序（`order by DESC`）则一定要在第二个`where`以及全句后面分别加一个。具体原理就是SQL的基础内容了……

刚刚总结的时候回顾项目，发现这些工作似乎可以直接放到数据库表值函数里面进行处理，反正都是一张查出来的虚表，放到数据库里似乎用起来更方便、速度也能更快。等理清楚思路试验一下，再来完整这篇总结吧。